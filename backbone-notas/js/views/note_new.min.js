(function(){APP.Views.NoteNewView=Backbone.View.extend({events:{"click button.save":"save"},initialize:function(a){this.note=a.note;this.notes=a.notes;
this.note.bind("invalid",this.showErrors,this);},showErrors:function(a,b){this.$el.find(".error").removeClass("error");this.$el.find(".alert").html(_.values(b).join("<br>")).show();
_.each(_.keys(b),_.bind(function(c){this.$el.find("*[name="+c+"]").parent().addClass("error");},this));},save:function(a){a.stopPropagation();a.preventDefault();
this.note.set({title:this.$el.find("input[name=title]").val(),author:this.$el.find("input[name=author]").val(),description:this.$el.find("textarea[name=description]").val(),id:Math.floor(Math.random()*100)+1});
if(this.note.isValid()){this.notes.add(this.note);window.location.hash="notes/index";}},render:function(){this.$el.html(_.template($("#formTemplate").html(),this.note.toJSON()));
this.$el.find("h2").text("Crear nueva nota");return this;}});}());